# -----------------------------------------
# ğŸ™ï¸ Proxy Reverso para WebSocket (Ratchet)
# -----------------------------------------

# Ativa reescrita
RewriteEngine On

# ğŸ”¸ Redireciona conexÃµes WebSocket do navegador (WSS â†’ WS interno)
RewriteCond %{HTTP:Upgrade} =websocket [NC]
RewriteCond %{HTTP:Connection} upgrade [NC]
RewriteRule ^nave/voice/?$ ws://127.0.0.1:8080/ [P,L]

# ğŸ”¸ MantÃ©m HTTPS ativo e forÃ§a SSL no restante do site
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# ğŸ”¸ CabeÃ§alhos para manter a conexÃ£o ativa
Header always set Connection keep-alive
Header always set Upgrade $http_upgrade
Header always set Access-Control-Allow-Origin "*"

# ğŸ”¸ CompactaÃ§Ã£o normal do site
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
